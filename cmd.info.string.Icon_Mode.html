<div style="padding:0;min-width:90px;min-height:100px;" class="cmd #history# tooltips cmd-widget #displayHistory#" data-type="info" data-subtype="other" data-cmd_id="#id#" data-cmd_uid="#uid#" data-eqLogic_id="#eqLogic_id#" data-eqLogic_id="#eqLogic_id#" title="#collectDate#">
    <!-- Info Widget
        Basé sur les widget de 	: 
        Mise à jour             : JAG 20190623 : Création et optimisation
		Info					: Merci à @Salvialf pour la duréee et @Nicoraptor pour le code pour récupérer valeur Mode
	-->
    <div class="title #hide_name#">
        <div class="cmdName" style="#hideCmdName#">#name_display#</div>
    </div>
        <div class="content-sm ">
            <span class="iconCmd#id#"></span>
    </div>
    <!-- Historique -->
        <div class="cmdStats #hide_history#" style="#displayHistory# font-size : 10px;">
            <span title="Min" class="tooltips">#minHistoryValue##unite#</span>|<span title="Moy" class="tooltips">#averageHistoryValue##unite#</span>|<span title="Max" class="tooltips">#maxHistoryValue##unite#</span> <i class="#tendance#"></i>
        </div>
    <!-- Durée -->
        <div style="font-weight: bold;font-size : 10px;">
            <span class="timeCmd#id#" ></span>
        </div>

    <script>
   var iconUpdate#uid# = function (state) {
        // Valeur par mode
                var mode0               = ('#mode0#' !='#'+'mode0#') ? "#mode0#":"Mode 0";
                var mode1               = ('#mode1#' !='#'+'mode1#') ? "#mode1#":"Mode 1";
                var mode2               = ('#mode2#' !='#'+'mode2#') ? "#mode2#":"Mode 2";
                var mode3               = ('#mode3#' !='#'+'mode3#') ? "#mode3#":"Mode 3";
                var mode4               = ('#mode4#' !='#'+'mode4#') ? "#mode4#":"Mode 4";
                var mode5               = ('#mode5#' !='#'+'mode5#') ? "#mode5#":"Mode 5";
                var mode6               = ('#mode6#' !='#'+'mode6#') ? "#mode6#":"Mode 6";
                var mode7               = ('#mode7#' !='#'+'mode7#') ? "#mode7#":"Mode 7";
                var mode8               = ('#mode8#' !='#'+'mode8#') ? "#mode8#":"Mode 8";
                var mode9               = ('#mode9#' !='#'+'mode9#') ? "#mode9#":"Mode 9";
                var mode10              = ('#mode10#' !='#'+'mode10#') ? "#mode10#":"Mode 10";
      
       // Image par mode
                var srcImglogoM0        = ('#logo0#' !='#'+'logo0#') ? "#logo0#":mode0;
                var srcImglogoM0_T      = ('#logo0_type#'!='#'+'logo0_type#') ? "#logo0_type#" : "png";
                var srcImglogoM1        = ('#logo1#' !='#'+'logo1#') ? "#logo1#":mode1;
                var srcImglogoM1_T      = ('#logo1_type#'!='#'+'logo1_type#') ? "#logo1_type#" : "png";
                var srcImglogoM2        = ('#logo2#' !='#'+'logo2#') ? "#logo2#":mode2;
                var srcImglogoM2_T      = ('#logo2_type#'!='#'+'logo2_type#') ? "#logo2_type#" : "png";
                var srcImglogoM3        = ('#logo3#' !='#'+'logo3#') ? "#logo3#":mode3;
                var srcImglogoM3_T      = ('#logo3_type#'!='#'+'logo3_type#') ? "#logo3_type#" : "png";
                var srcImglogoM4        = ('#logo4#' !='#'+'logo4#') ? "#logo4#":mode4;
                var srcImglogoM4_T      = ('#logo4_type#'!='#'+'logo4_type#') ? "#logo4_type#" : "png";
                var srcImglogoM5        = ('#logo5#' !='#'+'logo5#') ? "#logo5#":mode5;
                var srcImglogoM5_T      = ('#logo5_type#'!='#'+'logo5_type#') ? "#logo5_type#" : "png";
                var srcImglogoM6        = ('#logo6#' !='#'+'logo6#') ? "#logo6#":mode6;
                var srcImglogoM6_T      = ('#logo6_type#'!='#'+'logo6_type#') ? "#logo6_type#" : "png";
                var srcImglogoM7        = ('#logo7#' !='#'+'logo7#') ? "#logo7#":mode7;
                var srcImglogoM7_T      = ('#logo7_type#'!='#'+'logo7_type#') ? "#logo7_type#" : "png";
                var srcImglogoM8        = ('#logo8#' !='#'+'logo8#') ? "#logo8#":mode8;
                var srcImglogoM8_T      = ('#logo8_type#'!='#'+'logo8_type#') ? "#logo8_type#" : "png";
                var srcImglogoM9        = ('#logo9#' !='#'+'logo9#') ? "#logo9#":mode9;
                var srcImglogoM9_T      = ('#logo9_type#'!='#'+'logo9_type#') ? "#logo9_type#" : "png";
                var srcImglogoM10       = ('#logo10#' !='#'+'logo10#') ? "#logo10#":mode10;
                var srcImglogoM10_T     = ('#logo10_type#'!='#'+'logo10_type#') ? "#logo10_type#" : "png";
     
      // Paramétrage des images
                var srcFolder           = ('#dossier#'!='#'+'dossier#') ? "#dossier#" : "NULL";
            if (srcFolder == 'NULL') {
                var srcImgURL           = "plugins/widget/core/template/dashboard/cmd.info.string.Icon_Mode/";
            } else {
                var srcImgURL           = "plugins/widget/core/template/dashboard/cmd.info.string.Icon_Mode/"+srcFolder+'/';
            };
        // Paramètre "sizehw" : à déclarer en pixels - 80 maxi
                var srcImgHeight        = (is_numeric('#sizeh#')) ? parseFloat('#sizeh#') : 80;
                var srcImgWidth         = (is_numeric('#sizew#')) ? parseFloat('#sizew#') : 80;
                var srcImgSize          = 'height='+srcImgHeight+'px width='+srcImgWidth+'px';
       // Paramètrage du logo pour Erreur
                var srcImglogoER        = ('#logoER#'!='#'+'logoER#') ? "#logoER#": "oups";
                var srcImglogoER_T      = ('#logoER_type#'!='#'+'logoER_type#') ? "#logoER_type#": "png";        
        // Variable pour Update
                var srcPictureID;
          		var srcPictureID_T;
      
        $('.cmd[data-cmd_uid=#uid#] .iconCmd#id#').empty();
            if (state == mode0) {
                srcPictureID	= srcImglogoM0;
                srcPictureID_T	= srcImglogoM0_T;
            } else if (state == mode1) {
                srcPictureID	= srcImglogoM1;
                srcPictureID_T	= srcImglogoM1_T;
            } else if (state == mode2 ) {
                srcPictureID	= srcImglogoM2;
                srcPictureID_T	= srcImglogoM2_T;
            } else if (state == mode3) {
                srcPictureID	= srcImglogoM3;
                srcPictureID_T	= srcImglogoM3_T;
            } else if (state == mode4) {
                srcPictureID	= srcImglogoM4;
                srcPictureID_T	= srcImglogoM4_T;
            } else if (state == mode5) {
                srcPictureID	= srcImglogoM5;
                srcPictureID_T	= srcImglogoM5_T;
            } else if (state == mode6) {
                srcPictureID	= srcImglogoM6;
                srcPictureID_T	= srcImglogoM6_T;
            } else if (state == mode7) {
                srcPictureID	= srcImglogoM7;
                srcPictureID_T	= srcImglogoM7_T;
            } else if (state == mode8) {
                srcPictureID	= srcImglogoM8;
                srcPictureID_T	= srcImglogoM8_T;
            } else if (state == mode9) {
                srcPictureID	= srcImglogoM9;
                srcPictureID_T	= srcImglogoM9_T;
            } else if (state == mode10) {
                srcPictureID	= srcImglogoM10;
                srcPictureID_T	= srcImglogoM10_T;
            } else {
                srcPictureID	= srcImglogoER;
                srcPictureID_T	= srcImglogoER_T;
            }
        
        $('.cmd[data-cmd_uid=#uid#] .iconCmd#id#').html('<img src="'+srcImgURL+ srcPictureID +'.'+ srcPictureID_T +'" '+srcImgSize+'>');
        }
      
	jeedom.cmd.update['#id#'] = function(_options){
		$('.cmd[data-cmd_uid=#uid#]').attr('title','Valeur du '+_options.valueDate+', collectée le '+_options.collectDate)
		iconUpdate#uid#(_options.display_value);
            // Affichage durée changement dernier etat
                var srcImglogoTime		= '#logoTime#';
            // Derniere durée changement dernier etat
                //Merci @Salvialf pour le code
                if (srcImglogoTime == "duree") {
                    jeedom.cmd.displayDuration(_options.valueDate, $('.cmd[data-cmd_id=#id#] .timeCmd#id#'));
                } else if (srcImglogoTime == "date") {
                    var srcdate     = new Date(_options.valueDate);
                    var srcformat   = $.datepicker.formatDate('D dd/mm', srcdate);
                    var srctime     = "à "+srcdate.getHours()+":"+(srcdate.getMinutes()<10?'0':'')+srcdate.getMinutes();
                    $('.cmd[data-cmd_id=#id#] .timeCmd#id#').empty().html(srcformat+'<br>'+srctime);
                } else if (srcImglogoTime == "heure") {
                    var srcdate     = new Date(_options.valueDate);
                    var srctime     = "à "+srcdate.getHours()+":"+(srcdate.getMinutes()<10?'0':'')+srcdate.getMinutes()+":"+(srcdate.getSeconds()<10?'0':'')+srcdate.getSeconds()+"";
                    $('.cmd[data-cmd_id=#id#] .timeCmd#id#').empty().html(srctime);
                };
	}
	jeedom.cmd.update['#id#']({display_value:'#state#',valueDate:'#valueDate#',collectDate:'#collectDate#',alertLevel:'#alertLevel#'});
	</script>
</div>